<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reconstruction of Daily Data - Precipitation • reddPrec</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Reconstruction of Daily Data - Precipitation">
<meta property="og:description" content="Applies quality control to daily precipitation observations; 
    reconstructs the original series by estimating precipitation in missing values; and 
    creates gridded datasets of daily precipitation.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">reddPrec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level2">
<h2 id="introduction-to-reddprec">Introduction to reddPrec<a class="anchor" aria-label="anchor" href="#introduction-to-reddprec"></a>
</h2>
<p>The goal of <strong>reddPrec</strong> is to perform a complete reconstruction of daily precipitation. The process follows 3 steps: 1) quality control of daily raw precipitation observations; 2) gap filling of missing values in data series; 3) creation of gridded datasets.</p>
<p>While here is provided a simple explanation about how to use the functions, a detailed explanation of the methodology can be found in: <a href="https://doi.org/10.1016/j.envsoft.2016.11.005" class="external-link">Serrano-Notivoli et al., (2017)</a>.</p>
<p>Each one of the three steps can be applied independently through the three available functions:</p>
<ul>
<li>
<strong>qcPrec()</strong>: applies several threshold-based criteria to filter original observations of daily precipitation.</li>
<li>
<strong>gapFilling()</strong>: estimates new values for missing data in daily precipitation data series.</li>
<li>
<strong>gridPcp()</strong>: creates a gridded precipitation dataset from a station-based dataset of observations.</li>
</ul>
<p>While the whole package is designed to work with daily precipitation, monthly and annual data can be addressed.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Installation is straightforward since the package is available on CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"reddPrec"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="preparation-of-data">Preparation of data<a class="anchor" aria-label="anchor" href="#preparation-of-data"></a>
</h2>
<div class="section level3">
<h3 id="daily-precipitation-observations">Daily precipitation observations<a class="anchor" aria-label="anchor" href="#daily-precipitation-observations"></a>
</h3>
<p>We will use a set of daily precipitation observations from the Spanish Meterological Agency (AEMET) as example.</p>
<p>The package <a href="https://ropenspain.github.io/climaemet/" class="external-link">climaemet</a> facilitates the process of downloading the data, but you will need an API key from AEMET that can be freely obtained <a href="https://opendata.aemet.es/centrodedescargas/altaUsuario?" class="external-link">here</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ropenspain.github.io/climaemet/" class="external-link">climaemet</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># just replace "MY_API_KEY" by your personal API key and run this:</span></span>
<span><span class="co"># aemet_api_key("MY_API_KEY", install=TRUE)</span></span>
<span></span>
<span><span class="va">data_daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ropenspain.github.io/climaemet/reference/aemet_daily.html" class="external-link">aemet_daily_clim</a></span><span class="op">(</span>station <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>                               start <span class="op">=</span> <span class="st">"2022-05-01"</span>, </span>
<span>                               end <span class="op">=</span> <span class="st">"2022-05-31"</span>,</span>
<span>                               return_sf <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>We only want to analyze the Iberian Peninsula and Balearic Islands, so we crop the spatial domain of the data with package <a href="https://r-spatial.github.io/sf/" class="external-link">sf</a> using the boundaries of the Spanish regions (except Canary Islands) retrieved with package <a href="https://ropengov.github.io/giscoR/" class="external-link">giscoR</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ropengov.github.io/giscoR/" class="external-link">giscoR</a></span><span class="op">)</span></span>
<span><span class="va">spain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ropengov.github.io/giscoR/reference/gisco_get_nuts.html" class="external-link">gisco_get_nuts</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">"Spain"</span>, nuts_level <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span></span>
<span><span class="va">spain</span> <span class="op">&lt;-</span> <span class="va">spain</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">spain</span><span class="op">$</span><span class="va">NAME_LATN</span><span class="op">==</span><span class="st">'Canarias'</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">data_daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html" class="external-link">st_crop</a></span><span class="op">(</span><span class="va">data_daily</span>, <span class="va">spain</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: attribute variables are assumed to be spatially constant throughout</span></span>
<span><span class="co">## all geometries</span></span></code></pre>
<p>The daily data must be organized in a single matrix with columns (stations) and rows (days). To do that, we use the <a href="https://cran.r-project.org/web/packages/reshape/index.html" class="external-link">reshape</a> package which facilitates the task of <em>casting</em> data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/reshape" class="external-link">reshape</a></span><span class="op">)</span></span>
<span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">data_daily</span><span class="op">)</span>,<span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">data_daily</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">obs_pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/cast-9g.html" class="external-link">cast</a></span><span class="op">(</span><span class="va">dd</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'fecha'</span>,<span class="st">'indicativo'</span>,<span class="st">'prec'</span><span class="op">)</span><span class="op">]</span>, <span class="va">fecha</span><span class="op">~</span><span class="va">indicativo</span><span class="op">)</span></span></code></pre></div>
<p>AEMET codes low precipitation data (<em>PCP&lt;0.1</em>) as “Ip”. As the function only accepts numeric values, we ensure that no strings remain.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obs_pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">obs_pr</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">','</span>,<span class="st">'.'</span>,<span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">x</span><span class="op">==</span><span class="st">'Ip'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Lastly, we create a data.frame with the information of the stations</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID<span class="op">=</span><span class="va">dd</span><span class="op">$</span><span class="va">indicativo</span>, alt <span class="op">=</span> <span class="va">dd</span><span class="op">$</span><span class="va">altitud</span>, lon <span class="op">=</span> <span class="va">dd</span><span class="op">$</span><span class="va">X</span>, lat <span class="op">=</span> <span class="va">dd</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="va">stations</span> <span class="op">&lt;-</span> <span class="va">stations</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">stations</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creation-of-geospatial-raster-data">Creation of geospatial (raster) data<a class="anchor" aria-label="anchor" href="#creation-of-geospatial-raster-data"></a>
</h3>
<p>Te estimation of precipitation is used in all stages of the reconstruction process, and it uses environmental data as predictors. As we don’t have available this information for each station’s location, it can be extracted from raster data, but must create it first.</p>
<p>In this case, we will use five predictors: 1) elevation, 2) latitude, 3) longitude, 4) distance to the coast (as a cost-distance function with elevation) and 5) TRI (Terrain Ruggedness Index).</p>
<p>First, we use the <a href="https://github.com/jhollist/elevatr" class="external-link">elevatr</a> package to derive a raster of elevations. Then, the <a href="https://rspatial.org/pkg/index.html" class="external-link">terra</a> package will allow for calculating the required environmental predictors derived from elevations.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jhollist/elevatr/" class="external-link">elevatr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/elevatr/man/get_elev_raster.html" class="external-link">get_elev_raster</a></span><span class="op">(</span><span class="va">data_daily</span>, z <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="va">dem</span>, <span class="va">spain</span><span class="op">)</span></span>
<span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/mask.html" class="external-link">mask</a></span><span class="op">(</span><span class="va">dem</span>, <span class="va">spain</span><span class="op">)</span></span>
<span><span class="va">dem</span><span class="op">[</span><span class="va">dem</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span></span>
<span><span class="va">dc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/costDist.html" class="external-link">costDist</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span></span>
<span><span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/terrain.html" class="external-link">terrain</a></span><span class="op">(</span><span class="va">dem</span>, v <span class="op">=</span> <span class="st">'TRI'</span><span class="op">)</span></span></code></pre></div>
<p>Now we create the latitude and longitude rasters from the stations’ information.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crds.html" class="external-link">crds</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/pkg/terra/man/crds.html" class="external-link">crds</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,type<span class="op">=</span><span class="st">'xyz'</span>,crs<span class="op">=</span><span class="st">'EPSG:4326'</span><span class="op">)</span></span>
<span><span class="va">lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crds.html" class="external-link">crds</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/pkg/terra/man/crds.html" class="external-link">crds</a></span><span class="op">(</span><span class="va">dem</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,type<span class="op">=</span><span class="st">'xyz'</span>,crs<span class="op">=</span><span class="st">'EPSG:4326'</span><span class="op">)</span></span></code></pre></div>
<p>Lastly, we extract the values of distance to the coast and TRI to the stations</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">stations</span>, geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lon'</span>,<span class="st">'lat'</span><span class="op">)</span>,crs <span class="op">=</span> <span class="st">'EPSG:4326'</span>,keepgeom<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">stations</span><span class="op">$</span><span class="va">dc</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">dc</span>, <span class="va">stations</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">stations</span><span class="op">$</span><span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">tr</span>, <span class="va">stations</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">stations</span><span class="op">)</span></span></code></pre></div>
<p>Those stations with no overlapping with raster don’t have data, so we remove them</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stations</span> <span class="op">&lt;-</span> <span class="va">stations</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">stations</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">obs_pr</span> <span class="op">&lt;-</span> <span class="va">obs_pr</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">stations</span><span class="op">$</span><span class="va">ID</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">obs_pr</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>At his point, we have available the dataset with the original data.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">stations</span>, geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lon'</span>,<span class="st">'lat'</span><span class="op">)</span>,crs <span class="op">=</span> <span class="st">'EPSG:4326'</span>,keepgeom<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">st</span><span class="op">$</span><span class="va">ndata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">obs_pr</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">obs_pr</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dem</span>, main <span class="op">=</span> <span class="st">"Precipitation stations"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">st</span>, cex<span class="op">=</span><span class="va">st</span><span class="op">$</span><span class="va">ndata</span><span class="op">/</span><span class="fl">100</span>, pch <span class="op">=</span> <span class="fl">1</span>, add<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-12-1.png"><!-- --></p>
<p>And the environmental pedictors</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dem</span>, <span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dc</span>, <span class="va">tr</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alt"</span>,<span class="st">"lon"</span>,<span class="st">"lat"</span>,<span class="st">"dc"</span>,<span class="st">"tr"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-13-1.png"><!-- --></p>
</div>
</div>
<div class="section level2">
<h2 id="quality-control">Quality control<a class="anchor" aria-label="anchor" href="#quality-control"></a>
</h2>
<p>The quality control (QC) function allows for a customization of the thresholds applied to each criteria. In this case, we will flag and remove the observations based on the following conditionals:</p>
<ul>
<li>the coordinates (lon, lat) will be used as predictors</li>
<li>the 10 nearest observations to estimate precipitation</li>
<li>no maximum radius of searching nearest observations</li>
<li>we will apply the 5 reference QC criteria: suspect value, suspect zero, suspect outlier, suspect wet day and suspect dry day.</li>
<li>a threshold of 10 times higher or lower observation than estimate to detect outliers</li>
<li>a threshold of 0.99 wet probability and an observed magnitude higher than 5 mm to detect suspect zeros.</li>
<li>a threshold of 0.01 wet probability and an observed magnitude lower than 0.1 mm to detect suspect values higher than 5 mm.</li>
<li>two processor cores to compute results in parallel (usually the higher the faster, depending on your hardware capabilities)</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">reddPrec</span><span class="op">)</span></span>
<span><span class="va">qcdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/qcPrec.html">qcPrec</a></span><span class="op">(</span>prec <span class="op">=</span> <span class="va">obs_pr</span>, </span>
<span>                 sts <span class="op">=</span> <span class="va">stations</span>, </span>
<span>                 crs <span class="op">=</span> <span class="st">'EPSG:4326'</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lon'</span>,<span class="st">'lat'</span><span class="op">)</span>,</span>
<span>                 coords_as_preds <span class="op">=</span> <span class="cn">TRUE</span>, neibs <span class="op">=</span> <span class="fl">10</span>, thres <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                 qc <span class="op">=</span> <span class="st">'all'</span>, qc3 <span class="op">=</span> <span class="fl">10</span>, qc4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.99</span>, <span class="fl">5</span><span class="op">)</span>, qc5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>                 ncpu<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Depending on the velocity of your processor(s), the job will be done quick or slow, but this particular task (with our setting) should take a few minutes. If you use a large dataset of observations, the computing time rises.</p>
<p>The result is a list of two elements:</p>
<ul>
<li>
<strong>cleaned</strong>: a matrix (stations x days) with the filtered observations (cleaned data).</li>
<li>
<strong>codes</strong>: a matrix (stations x days) with the codes corresponding to the reasons of values removal
<ul>
<li>“1” (suspect value): obs==0 &amp; all(neibs&gt;0)</li>
<li>“2” (suspect zero): obs&gt;0 &amp; all(neibs==0)</li>
<li>“3” (suspect outlier): obs is “qc3” times higher or lower than the estimate</li>
<li>“4” (suspect wet): obs==0 &amp; wet probability &gt; “qc4[1]” &amp; estimate &gt; “qc4[2]”</li>
<li>“5” (suspect dry): obs&gt;“qc5[3]” &amp; dry probability &lt; “qc5[1]” &amp; estimate &lt; “qc5[2]”)</li>
</ul>
</li>
</ul>
<p>In our particular example, the outliers (QC3) were the most flagged values (3.05%), followed by suspect values (QC1, 0.90%), suspect dry (QC5, 0.42%), suspect wet (QC4, 0.21%) and suspect zeros (QC2, 0.11%).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allcodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/coerce.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">qcdata</span><span class="op">$</span><span class="va">codes</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">flagged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">allcodes</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">allcodes</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">flagged</span></span></code></pre></div>
<pre><code><span><span class="co">## allcodes</span></span>
<span><span class="co">##    1    2    3    4    5 </span></span>
<span><span class="co">## 0.90 0.11 3.05 0.21 0.42</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="gap-filling">Gap filling<a class="anchor" aria-label="anchor" href="#gap-filling"></a>
</h2>
<p>Missing values are common in raw original data series of observations. After the QC process, the number of these missing data is increased, and the resulting gaps can affect to further analyses at coarser scales (seasonal, annual, etc.). To solve that, a large collection of infilling methods exist, most of them based on regression algorithms.</p>
<p>The gap filling process in <strong>reddPrec</strong> uses the nearest observations (a number defined by the user) and their associated environmental information (which we added to the <em>stations</em> data.frame in the “data preparation” section) to compute a Reference Value (RV). The RV is computed through a multivariate linear regression that uses all those data.</p>
<p>The function returns a data.frame with different estimates for all days of every station:</p>
<ul>
<li>
<strong>wd_pred</strong>: probability (0 to 1) of wet day</li>
<li>
<strong>raw_pred</strong>: rainfall prediction (in the original units) obtaind from the model</li>
<li>
<strong>mod_pred</strong>: modified prediction based on wet day probability (if wd_pred&lt;0.5 -&gt; mod_pred = 0)</li>
<li>
<strong>st_pred</strong>: standardized prediction (based on mod_pred) from selected standardization method (ratio or quantile)</li>
<li>
<strong>err</strong>: standard error of the model (in the original units)</li>
<li>
<strong>neibs</strong>: number of nearest stations (neighbors) used in the model. They can vary if a searching threshold (thres) is set.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gf_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gapFilling.html">gapFilling</a></span><span class="op">(</span>prec <span class="op">=</span> <span class="va">qcdata</span><span class="op">$</span><span class="va">cleaned</span>, </span>
<span>                     sts <span class="op">=</span> <span class="va">stations</span>,</span>
<span>                     dates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">'2022-05-01'</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">'2022-05-31'</span><span class="op">)</span>,</span>
<span>                                      by <span class="op">=</span><span class="st">'day'</span><span class="op">)</span>, </span>
<span>                     stmethod <span class="op">=</span> <span class="st">'ratio'</span>, </span>
<span>                     ncpu <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                     thres <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>                     neibs <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                     coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lon'</span>,<span class="st">'lat'</span><span class="op">)</span>,</span>
<span>                     crs <span class="op">=</span> <span class="st">'EPSG:4326'</span>,</span>
<span>                     coords_as_preds <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     window <span class="op">=</span> <span class="fl">31</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [2024-01-17 07:55:29.476654] - Filling gaps</span></span></code></pre>
<pre><code><span><span class="co">## [2024-01-17 07:55:43.014059] - Standardizing final data series</span></span></code></pre>
<pre><code><span><span class="co">## [2024-01-17 07:55:43.324543] - END</span></span></code></pre>
<p>Our example doesn’t show any difference between <strong>mod_pred</strong> and <strong>st_pred</strong> since we used a window of 31 days, which was the complete length of the dataset.</p>
<p>We can compare, for example, the original data series and their reconstructions.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># daily</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gf_res</span><span class="op">$</span><span class="va">obs</span>, <span class="va">gf_res</span><span class="op">$</span><span class="va">st_pred</span>, xlab <span class="op">=</span> <span class="st">'Observed (mm)'</span>, ylab <span class="op">=</span> <span class="st">'Predicted (mm)'</span>, main <span class="op">=</span> <span class="st">'Daily PCP comparison (all stations)'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Pearson = '</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">gf_res</span><span class="op">$</span><span class="va">obs</span>, <span class="va">gf_res</span><span class="op">$</span><span class="va">st_pred</span>, use<span class="op">=</span><span class="st">"pairwise.complete.obs"</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-17-1.png"><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># monthly average (only considering days with observation)</span></span>
<span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="va">gf_res</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">gf_res</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">obs</span><span class="op">$</span><span class="va">obs</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">obs</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">sum</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">obs</span><span class="op">$</span><span class="va">st_pred</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">obs</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">sum</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">o</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">p</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, xlab <span class="op">=</span> <span class="st">'Observed (mm)'</span>, ylab <span class="op">=</span> <span class="st">'Predicted (mm)'</span>, main <span class="op">=</span> <span class="st">'Monthly PCP comparison (all stations)'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Pearson = '</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">o</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">p</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, use<span class="op">=</span><span class="st">"pairwise.complete.obs"</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-17-2.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="gridding">Gridding<a class="anchor" aria-label="anchor" href="#gridding"></a>
</h2>
<p>The final step creates a gridded product based on the environmental variables in raster format. Different inputs can be used as observations: (i) the original observations or (ii) the reconstructed series. Reconstructed series are recommended due to the neighboring stations for all pixels will remain the same in all days of the period. Otherwise, some inconsistencies (inhomogeneities) could be imputed to the grid and spatially propagated.</p>
<p>We will use reconstructed series for our example, 15 neighbors with no radius limitation. Please consider that, although here the three steps (QC, gap filling and gridding) are presented as a workflow, they can be run separately, meaning that the options used in gridding can be different than gap fillin, for example.</p>
<p>The gridding process will take a long time depending on multiple factors: the grid resolution, the number of days, the number of neighbors, and the number of used CPUs, mainly. In our example, we will aggregate the grid at a coarser resolution and will reduce the time period to two days just to reduce the computing time. (This example takes about 3 minutes each day)</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">gf_res</span><span class="op">$</span><span class="va">date</span>, ID <span class="op">=</span> <span class="va">gf_res</span><span class="op">$</span><span class="va">ID</span>, pred <span class="op">=</span> <span class="va">gf_res</span><span class="op">$</span><span class="va">st_pred</span><span class="op">)</span></span>
<span><span class="va">rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/cast-9g.html" class="external-link">cast</a></span><span class="op">(</span><span class="va">rec</span>, <span class="va">date</span><span class="op">~</span><span class="va">ID</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using pred as value column.  Use the value argument to cast to override this choice</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rec</span> <span class="op">&lt;-</span> <span class="va">rec</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">env2</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">env</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">rec2</span> <span class="op">&lt;-</span> <span class="va">rec</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="reference/gridPcp.html">gridPcp</a></span><span class="op">(</span>prec <span class="op">=</span> <span class="va">rec2</span>,</span>
<span>        grid <span class="op">=</span> <span class="va">env2</span>,</span>
<span>        sts <span class="op">=</span> <span class="va">stations</span>,</span>
<span>        dates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">'2022-05-01'</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">'2022-05-02'</span><span class="op">)</span>,by <span class="op">=</span><span class="st">'day'</span><span class="op">)</span>,</span>
<span>        ncpu <span class="op">=</span> <span class="fl">4</span>,</span>
<span>        thres <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>        neibs <span class="op">=</span> <span class="fl">15</span>,</span>
<span>        coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lon'</span>,<span class="st">'lat'</span><span class="op">)</span>,</span>
<span>        crs <span class="op">=</span> <span class="st">'EPSG:4326'</span>,</span>
<span>        coords_as_preds <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [2024-01-17 07:55:43.461083] - Computing day 2022-05-01</span></span></code></pre>
<pre><code><span><span class="co">## [2024-01-17 07:57:03.973424] - Computing day 2022-05-02</span></span></code></pre>
<pre><code><span><span class="co">## [2024-01-17 07:58:23.712944] - END</span></span></code></pre>
<p>The function creates 2 folders in the working directory, one containing the daily grids of precipitation estimates and one containing the daily grids of uncertainties (errors of the model)</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">'./pred/'</span>, full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">'./err/'</span>, full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pre</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">err</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">80</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-19-1.png"><!-- --></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pre</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="va">err</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">80</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-19-2.png"><!-- --></p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=reddPrec" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing reddPrec</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Roberto Serrano-Notivoli <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7663-1202" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Roberto Serrano-Notivoli.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
